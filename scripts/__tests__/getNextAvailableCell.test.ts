import { test, expect, describe } from "vitest";
import { getNextAvailableCell } from "../generateSolutions";

describe("nextAvailableCell", () => {
  test("empty grid", () => {
    const grid: number[][] = [
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    ];

    const nextAvailableCell = getNextAvailableCell(grid);
    expect(nextAvailableCell).toEqual([0, 0]);
  });

  test("completed grid", () => {
    const grid: number[][] = [
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    ];

    const nextAvailableCell = getNextAvailableCell(grid);
    expect(nextAvailableCell).toEqual(false);
  });

  test("placed piece ", () => {
    const grid: number[][] = [
      [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    ];

    const nextAvailableCell = getNextAvailableCell(grid);
    expect(nextAvailableCell).toEqual([3, 0]);
  });

  test("placed piece with gaps", () => {
    const grid: number[][] = [
      [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    ];

    const nextAvailableCell = getNextAvailableCell(grid);
    expect(nextAvailableCell).toEqual([0, 0]);
  });

  test("placed piece and starting offset", () => {
    const grid: number[][] = [
      [1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    ];

    const nextAvailableCell = getNextAvailableCell(grid, [1, 0]);
    expect(nextAvailableCell).toEqual([3, 0]);
  });

  test("placed pieces and starting offset", () => {
    const grid: number[][] = [
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      [1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    ];

    const nextAvailableCell = getNextAvailableCell(grid, [1, 0]);
    expect(nextAvailableCell).toEqual([4, 1]);
  });
});
